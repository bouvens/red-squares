webpackJsonp([0,2],{0:function(e,t,a){a("+prg"),e.exports=a("lVK7")},"Ue/Q":function(e,t){},pnOm:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var s=a("U7vG"),n=r(s);a("Ue/Q");var o=a("3VDB"),u=r(o),i={frameLength:20,heroSize:50,threatSize:30,threatLimit:10,threatAddTimeout:1500,threatRemoveProbability:20},l=function(){return n.default.createElement(u.default,i)};t.default=l,e.exports=t.default},"7hJZ":function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var s=a("U7vG"),n=r(s),o=a("L/hj"),u=function(e){return n.default.createElement("div",{ref:e.refHandler,className:e.style},e.children)};u.defaultProps={children:null,refHandler:o.noOp},t.default=u,e.exports=t.default},"3VDB":function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0,t.default=void 0;var u,i,l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},d=a("U7vG"),h=r(d),f=a("tNBi"),p=r(f),c=a("7hJZ"),m=r(c),y=a("CMFL"),v=r(y),S={normal:{id:"normal",style:p.default.hero},trouble:{id:"trouble",style:p.default.heroInTrouble}},_={play:"play",pause:"pause",stop:"stop"},b=(i=u=function(e){function t(){var a,r,o;s(this,t);for(var u=arguments.length,i=Array(u),d=0;d<u;d++)i[d]=arguments[d];return a=r=n(this,e.call.apply(e,[this].concat(i))),r.state={status:_.stop,hero:{x:0,y:0,status:S.normal},threats:[],beats:0},r.keyPressed=[],r.saveMousePos=function(e){t.mousePos={x:e.pageX,y:e.pageY}},r.saveKeyPressed=function(e){var t=e.key;return r.keyPressed.push(t)},r.buttonPressProceed=function(){switch(r.state.status){case _.play:r.setState({status:_.pause});break;case _.pause:r.setState({status:_.play});break;case _.stop:default:r.setState({status:_.play}),r.frame=0,r.lastTreatTime=0-r.props.threatAddTimeout/r.props.frameLength,clearInterval(r.interval),r.startInterval(),r.setState({threats:[],beats:0})}},r.getButtonName=function(){switch(r.state.status){case _.play:return"Pause";case _.pause:return"Resume";case _.stop:return"Start";default:return"WAT"}},r.keymap={" ":r.buttonPressProceed},r.reactToKeys=function(){r.keyPressed.forEach(function(e){return r.keymap[e]&&r.keymap[e]()}),r.keyPressed=[]},r.threatsIndex=0,r.startInterval=function(){r.interval=setInterval(r.updateFrame,r.props.frameLength)},r.updateFrame=function(){r.reactToKeys(),r.state.status===_.play&&(r.moveThreats(),r.controlThreats(),r.moveHero(),r.frame+=1)},r.saveFieldSize=function(){var e=r.field;r.setState({field:{left:e.offsetLeft,top:e.offsetTop,right:e.offsetLeft+e.clientWidth,bottom:e.offsetTop+e.clientHeight,width:e.clientWidth,height:e.clientHeight}})},r.moveThreats=function(){r.setState({threats:r.state.threats.map(function(e){return l({},e,{x:e.x+e.speed.x,y:e.y+e.speed.y})})})},r.processSpeed=function(e,t,a,s){var n=s.axis,o=s.lean,u=l({},e),i=Math.sign(o)===Math.sign(u.speed[n]);return u.isOut||(a&&i?u.isOut=!0:(i&&r.setState({beats:r.state.beats+1}),u.speed[n]=(i?-1:1)*(u.speed[n]||1))),u.isAroundField=Math.abs(o)<=3*t,u},r.beat=function(e){return function(t){var a=l({},t),s=Math.random()<1/r.props.threatRemoveProbability,n=r.processSpeed.bind(null,a,r.props.threatSize,s);a.x<0&&(a=n({axis:"x",lean:a.x}));var o=e.width-r.props.threatSize;a.x>o&&(a=n({axis:"x",lean:a.x-o})),a.y<0&&(a=n({axis:"y",lean:a.y}));var u=e.height-r.props.threatSize;return a.y>u&&(a=n({axis:"y",lean:a.y-u})),a}},r.addThreat=function(e,t){var a=r.props.threatSize,s=Math.round(Math.random()*(e.width-a)),n=0-a,o={x:Math.round(8*Math.random()-4),y:Math.ceil(4*Math.random())};Math.random()<.5?(s=0-a,n=Math.round(Math.random()*(e.height-a)),o={x:Math.ceil(4*Math.random()),y:Math.round(8*Math.random()-4)},Math.random()<.5&&(s=e.width,o.x=-o.x)):Math.random()<.5&&(n=e.height,o.y=-o.y),t.push({id:r.threatsIndex+=1,x:s,y:n,speed:o,isOut:!1,isAroundField:!0}),r.lastTreatTime=r.frame,r.setState({threats:t})},r.controlThreats=function(){var e=r.state.field,t=r.state.threats.map(r.beat(e));t=t.filter(function(e){return e.isAroundField}),t.length<r.props.threatLimit&&r.frame>=r.lastTreatTime+r.props.threatAddTimeout/r.props.frameLength&&r.addThreat(e,t),r.setState({threats:t})},r.getHeroStatus=function(e,t){var a=r.props,s=a.heroSize,n=a.threatSize,o=(s+n)/2,u=(n-s)/2;return r.state.threats.some(function(a){return Math.abs(a.x-e+u)<o&&Math.abs(a.y-t+u)<o})?(r.setState({status:_.stop}),S.trouble):S.normal},r.moveHero=function(){var e=r.state.field,a=Math.max(t.mousePos.x-r.props.heroSize/2,e.left);a=Math.min(a,e.right-r.props.heroSize),a-=e.left;var s=Math.max(t.mousePos.y-r.props.heroSize/2,e.top);s=Math.min(s,e.bottom-r.props.heroSize),s-=e.top,r.setState({hero:{x:a,y:s,status:r.getHeroStatus(a,s)}})},r.getS=function(e){return 1!==e?"s":""},o=a,n(r,o)}return o(t,e),t.prototype.componentDidMount=function(){var e=this;document.onmousemove=this.saveMousePos,this.saveFieldSize(),window.onresize=this.saveFieldSize,setTimeout(function(){return e.setState({hero:l({},e.state.hero,{x:(e.field.clientWidth-e.props.heroSize)/2,y:(e.field.clientHeight-e.props.heroSize)/2})})},0),window.document.onkeyup=this.saveKeyPressed,this.startInterval()},t.prototype.render=function(){var e=this;return h.default.createElement("div",{className:p.default.wrapper},h.default.createElement(m.default,{style:p.default.field,refHandler:function(t){e.field=t}},h.default.createElement(v.default,{style:this.state.hero.status.style,refHandler:function(t){e.hero=t},size:this.props.heroSize,left:this.state.hero.x,top:this.state.hero.y}),this.state.threats.map(function(t){return h.default.createElement(v.default,{key:t.id,style:p.default.threat,size:e.props.threatSize,left:t.x,top:t.y})})),h.default.createElement("div",{className:p.default.side},h.default.createElement("button",{onClick:this.buttonPressProceed},this.getButtonName())," (Press Space)",h.default.createElement("h2",null,this.state.beats||"No"," beat",this.getS(this.state.beats)),h.default.createElement("p",null,this.state.threats.length||"No"," threat",this.getS(this.state.threats.length)," on field")))},t}(d.Component),u.mousePos={x:0,y:0},i);t.default=b,e.exports=t.default},tNBi:function(e,t){e.exports={wrapper:"RedSquares__wrapper__n469N",side:"RedSquares__side__1Qama",field:"RedSquares__field__3S_U-",hero:"RedSquares__hero__3dJES",heroInTrouble:"RedSquares__heroInTrouble__3OuzF",threat:"RedSquares__threat__3sdY0"}},CMFL:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var s=a("U7vG"),n=r(s),o=a("L/hj"),u=function(e){return n.default.createElement("div",{ref:e.refHandler,className:e.style,style:{width:e.size+"px",height:e.size+"px",top:e.top+"px",left:e.left+"px"}})};u.defaultProps={refHandler:o.noOp},t.default=u,e.exports=t.default},cilB:function(e,t){},lVK7:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var s=a("U7vG"),n=r(s),o=a("O27J"),u=a("pnOm"),i=r(u);a("cilB"),(0,o.render)(n.default.createElement(i.default,null),document.querySelector("#app"))},"L/hj":function(e,t){"use strict";t.__esModule=!0;t.noOp=function(){}}});
//# sourceMappingURL=app.36ce042b.js.map